---
layout: post
title:  "性能测试工具"
date:   2016-07-26 15:42:32 +0800
categories: work notes
---
# 一、Apache ab
### 原理
ab命令会创建很多的并发访问线程，模拟多个访问者同时对某一URL地址进行访问，其原理类似CC攻击（Challenge Collapsar，挑战黑洞）。

因此，既可以用来测试Apache的负载压力，也可以测试nginx、lighthttp、tomcat、IIS等其它Web服务器的压力。
### 用法
参数很多，一般我们用 -c 和 -n 参数就可以了。

` ab -c 5000 -n 600 http://127.0.0.1/index.php `

-n后面的5000代表总共发出5000个请求；-600（模拟600个人同时访问），后面的网址表示测试的目标URL。

### 特点
ab命令对发出负载的计算机要求很低，既不会占用很高CPU，也不会占用很多内存，但却会给目标服务器造成巨大的负载。自己测试使用也须注意，否则一次上太多的负载，可能造成目标服务器因资源耗完，严重时甚至导致死机。

在远程对web服务器进行压力测试，往往效果不理想（因为网络延时过大），建议使用内网的另一台或者多台服务器通过内网进行测试，这样得出的数据，准确度会高很多。
# 二、Jemeter
### 原理
jmeter的架构和loadrunner原理一样，都是通过中间代理，监控和收集并发客户端发出的指令，把他们生成脚本，再发送到应用服务器，再监控服务器反馈结果的一个过程；
### 特点
支持多种服务类型测试，包括HTTP、HTTPS、SOAP、JDBC、Mail-POP3、LDAP等。可以录制、回访测试脚本。100%纯Java程序，具备高可移植性。

分布式中间代理功能在jmeter中也有，这个分页式代理是指可设置多台代理在不同PC中，通过远程进行控制，即通过使用多台机器运行的谓的agant来分担load generator自身的压力，并借引来获取更大的并发用户数。

jmeter可以通过逻辑控制器实现复杂的测试行为，相当于loadrunner中的测试场景；
### Jemeter与LoadRunner比较

对比项 | JMeter | LoadRunner
---|---|---
安装 | 简单，下载加压即可 | 复杂，安装包大约1G，安装时间大于1小时
录制/回放模式 | 支持| 支持
测试协议 | 偏少，用户可自行扩展 | 较多，用户不可自行扩展
分布式大规模压力测试 |支持 |支持
IP欺骗功能 |不支持 |支持
图形报表 |支持（较弱） |支持（很强）
测试逻辑控制 |支持 |支持
监控服务器资源（CPU，内存等） |支持 |支持
功能测试 |支持 |不支持
